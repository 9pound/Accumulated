# 类加载器

类加载器是一段代码，它实现了“通过一个类的全限定名来获取描述此类的二进制字节流”的功能

## 类加载器的分类

**启动类加载器**

- 由C++语言实现，是虚拟机的一部分
- 启动器类加载器无法被Java程序直接引用
  - 负责加载《JAVA_HOME》\lib目录中的类

**其他类加载器**

由java语言实现，独立于虚拟机外部

- 扩展类加载器
  - 开发者可以直接使用扩展类加载器
  - ExtClassLoader
  - 负责加载《JAVA_HOME》\lib\ext

- 应用程序类加载器
  - ClassLoader.getSystemClassLoader()
  - 负责夹杂ClassPath路径上所指定的类库

## 双亲委派模型

**虚拟机中如何确定类的唯一性：**

- 来源于同一个Class文件
- 被相同的类加载器加载

两个类由同一个类加载器加载，且这两个类来源于同一个Class文件，那么这两个类相等

**工作原理：**

​	如果一个类加载器收到了类加载请求，它首先不会自己去尝试加载这个类，而是把这个请求委派给父类加载器去完成，所有的加载请求最终都被传送到顶层的启动类加载器中，只有当符加载器反馈自己无法完成这个加载请求时（在它的搜索范围中没有找到所需类），子加载器才会尝试自己去加载

**是什么？**

​	类加载器之间的层次关系称为双亲委派模型

![image-20200804142644293](%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8.assets/image-20200804142644293.png)

**好处：例子**

​	例如Object类，无论哪个类加载器要加载这个类，最终都是委派给处于模型最顶端的启动器类加载器进行加载，因此Object类在程序的各个类记载器环境中都是同一个类

## OSGI

特点

​	每个程序模块都有一个自己的类加载器、当需要更换一个Bundle时，就把Bundle连同类加载器一起换掉以实现代码热替换

区别:

​	双亲委派模型中的类加载器时树状结构，而OSGI是网状结构